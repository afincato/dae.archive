<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<script>

const url = 'http://80.100.106.160/api'

async function postData(url = '', data = {}) {
  const response = await fetch(url, {
    method: 'POST',
    mode: 'cors',
    cache: 'no-cache',
    credentials: 'same-origin',
    headers: {
      'Content-Type': 'application/json'
      // 'Content-Type': 'application/x-www-form-urlencoded',
    },
    redirect: 'follow',
    referrer: 'no-referrer',
    body: JSON.stringify(data)
  })
  return await response.json();
}

async function checkAuth() {
  const res = await fetch(`${url}/users/4`, {
    credentials: 'same-origin'
  })
  console.log(res)
  return res.ok
}

async function login(email, pass) {
  const res = await postData(`${url}/users/login`, {
    email: email,
    password: pass
  })
  console.log(res)
}

async function doit() {
  const ok = await checkAuth()

  if(!ok) {
    login('jbg@peerparty.org', '1X8YshljFCBMMsyVqJ-GV09A5dvzoKAb')
  } else {
    console.log("OK!")
  }
}

doit()


</script>
</body>
</html>
