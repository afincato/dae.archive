<VirtualHost *:80>
  ServerName dev.designacademy.nl
  ServerAlias apidev.designacademy.nl searchdev.designacademy.nl wikidev.designacademy.nl localhost

  ServerAdmin webmaster@localhost
  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

  Header set Access-Control-Allow-Origin "*"
  Header always set Access-Control-Max-Age "1000"
  Header always set Access-Control-Allow-Headers "X-Requested-With, Content-Type, Origin, Authorization, Accept, Client-Security-Token, Accept-Encoding"
  Header always set Access-Control-Allow-Methods "POST, GET, OPTIONS, DELETE, PUT"

  # suggestion from: https://httpd.apache.org/docs/2.4/mod/mod_userdir.html
  UserDir disabled root
  #
  # ..this has no meaning in the httpd container,
  # because there are no home dirs, or users there..
  #
  # combined api and wiki settings:
  #UserDir public_html wiki

  DocumentRoot /archive

  Alias "/archive" "/archive"

  <LocationMatch "^/archive">
    IndexOptions FancyIndexing FoldersFirst HTMLTable IconsAreLinks SuppressDescription
    IndexStyleSheet /jbg/apache/autoindex.css

    ReadmeName /jbg/apache/removeFiles.html
  </LocationMatch>

  ProxyPass "/api/search" "http://solr:8983/solr/dae/query"
  ProxyPassReverse "/api/search" "http://solr:8983/solr/dae/query"

  ProxyPass "/api" "http://archive:3000"
  ProxyPassReverse "/api" "http://archive:3000"

  ProxyPass "/auth" "http://archive:3000"
  ProxyPassReverse "/auth" "http://archive:3000"

  ProxyPass "/wiki/search" "http://solr:8983/solr/dae-wiki/query"
  ProxyPassReverse "/wiki/search" "http://solr:8983/solr/dae-wiki/query"

  <LocationMatch "^/(?!archive|api|auth|wiki)">
    ProxyPass "http://archive:5000"
    ProxyPassReverse "http://archive:5000"
  </LocationMatch>
</VirtualHost>
